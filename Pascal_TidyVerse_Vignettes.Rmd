---
title: "DATA 607 - TidyVerse Dog Bites Vignette"
author: "Pascal Hermann Kouogang Tafo"
date: "2025-10-28"
output:
  pdf_document: default
  html_document: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Introduction

**In order to create a Tidyverse Vignette, I will be using the kaggle source where i will look at all dogs' bites that have been registered in New York City from 2015 to 2021.**


## Load the required package


```{r Loading-package}

library(tidyverse)

```


## Let's read the Data from GitHub


```{r Read-Data}

NYC_Dogs_Bites <- read_csv("https://raw.githubusercontent.com/Pascaltafo2025/DATA-607/main/Dog_Bites_Data.csv")

head(NYC_Dogs_Bites)

colnames(NYC_Dogs_Bites)

sort(unique(year(mdy(NYC_Dogs_Bites$DateOfBite))))
```


*Our dataset is very large because it contains the dogs bites in NYC from 2015 to 2021. I decided to conduct my analysis only in the year 2021.*


# *Data Cleaning*

*In the section, i will column(s) that i believe are not relevant for the analysis, select only the records for my year of interest.*

```{r Data-Cleaning}

library(lubridate)

# Let's do our first clean up by selecting our year of interest and getting ride of the unnecessary columns. 

NYC_Dog_Bites2021 <- NYC_Dogs_Bites %>%
  select(-UniqueID,-Species,-ZipCode) %>% #remove UniqueID column
  mutate(Year = year(mdy(DateOfBite))) %>%  # convert the Date format MDY to only year
  filter(Year == 2021)  # keep only year 2021

head(NYC_Dog_Bites2021,10)

```


# *DATA ANALYSIS*

*My goal is to compare dogs bites incidents by breed and check if there is a correlation between the dog breed and their Sterilization status.*

*1) Let's find the number of incidents by breed.*

```{r count-breeds}
  
# Data preparation for analysis

NYC_Dog_Bites2021 <- NYC_Dog_Bites2021 %>%
  filter(Breed != "UNKNOWN")  # remove the Unknown dogs breed

# Let's count the incidents by breed

DogsBites_by_breed <- NYC_Dog_Bites2021 %>%
  group_by(Breed) %>%
  summarise(n_incidents = n()) %>%
  arrange(desc(n_incidents))

DogsBites_by_breed

```

*This result shows that Pit Bull is the most mentioned breed with 521 cases of dogs bites registered in New York City in 2021 followed by the Mixed, the German Shepherd breeds respectively with 112 and 85 cases. *


*2) Let's find the relationship between the dog breed and whether or not they are spayNeuter.*

```{r Breed-vs-SpayNeuter}

Breed_SpayNeuter <- NYC_Dog_Bites2021 %>%
  count(Breed, SpayNeuter) %>%
  group_by(Breed) %>%
  mutate(percent = 100 * n / sum(n)) %>%
  arrange(desc(n))

head(Breed_SpayNeuter,10)


```



# *DATA VISUALIZATION*


*We will generate a plot that will show the proportion of dog bites incidents by breed depending if they are Spayed/Neutered or not. Since we have too many breeds registered, we will on the top 10 most registered breeds.*


```{r Top10Breeds-plot}

# let's get the top 10 Breeds by count

top10_Breeds <- NYC_Dog_Bites2021 %>%
                filter(!is.na(Breed), 
                str_to_lower(Breed) != "unknown",
                !is.na(SpayNeuter)) %>%
                add_count(Breed, name = "breed_total") %>%
                filter(breed_total %in% tail(sort(unique(breed_total)), 10))

# Create plot

ggplot(data= top10_Breeds, aes(x = fct_reorder(Breed, Breed, length), y = 1, fill = SpayNeuter)) +
  geom_col(position = "fill") +
  coord_flip() +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Spay/Neuter Status by Top 5 Dog Breeds in Bite Incidents for 2021",
    x = "Dog Breed",
    y = "Proportion of Incidents",
    fill = "Spay/Neuter Status") +
  theme_minimal()


```

# *INTERPRETATION*

*Overall, the graph shows that dogs that are spayed or Neutered are less likely involved in New York City dogs bites incidents.In fact, only 2 out of the top 10 Breeds by count that are Spayed or Neutered have an incident proportion higher than 25%. * 



# TidyVerse Extension - James Chun

I will be extending on Pascal's code in two ways. Firstly, I will focus on the dog bites from 2019. The motivation is that 2020-2021 were the COVID pandemic years, where quarantine and social distancing policies were in effect. As a result, this may have affected the number of person-person (and thus person-dog) interactions there were for those years. Therefore, perhaps analyzing a year before the pandemic would reveal some different results.  
<br>
The second extension will be some additional analysis, as described later.  

## Data Cleaning

```{r Data-Clean}

NYC_Dog_Bites2019 <- NYC_Dogs_Bites %>%
  select(-UniqueID,-Species,-ZipCode) %>% #remove UniqueID column
  mutate(Year = year(mdy(DateOfBite))) %>%  # convert the Date format MDY to only year
  filter(Year == 2019)  # keep only year 2021

head(NYC_Dog_Bites2019,10)
```

## Data Analysis

### Repeat Analysis

The first analysis done will be a repeat of Pascal's analysis, to determine if the ***NYC_Dog_Bites2019*** data has any significant differences from the ***NYC_Dog_Bites_2021***.

```{r count-breeds}
  
# Data preparation for analysis

NYC_Dog_Bites2019 <- NYC_Dog_Bites2019 %>%
  filter(Breed != "UNKNOWN")  # remove the Unknown dogs breed

# Let's count the incidents by breed

DogsBites_by_breed_2019 <- NYC_Dog_Bites2019 %>%
  group_by(Breed) %>%
  summarise(n_incidents = n()) %>%
  arrange(desc(n_incidents))

DogsBites_by_breed_2019

```

```{r Breed-vs-SpayNeuter}

Breed_SpayNeuter_2019 <- NYC_Dog_Bites2019 %>%
  count(Breed, SpayNeuter) %>%
  group_by(Breed) %>%
  mutate(percent = 100 * n / sum(n)) %>%
  arrange(desc(n))

head(Breed_SpayNeuter_2019,10)


```

```{r Top10Breeds-plot}

# let's get the top 10 Breeds by count

top10_Breeds_2019 <- NYC_Dog_Bites2019 %>%
                filter(!is.na(Breed), 
                str_to_lower(Breed) != "unknown",
                !is.na(SpayNeuter)) %>%
                add_count(Breed, name = "breed_total") %>%
                filter(breed_total %in% tail(sort(unique(breed_total)), 10))

# Create plot

ggplot(data= top10_Breeds_2019, aes(x = fct_reorder(Breed, Breed, length), y = 1, fill = SpayNeuter)) +
  geom_col(position = "fill") +
  coord_flip() +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Spay/Neuter Status by Top 5 Dog Breeds in Bite Incidents for 2019",
    x = "Dog Breed",
    y = "Proportion of Incidents",
    fill = "Spay/Neuter Status") +
  theme_minimal()
```

### New Analysis

The new analysis I will perform will count the incidents by gender.

```{r count-gender}
  
# Let's count the incidents by gender

DogsBites_by_gender_2019 <- NYC_Dog_Bites2019 %>%
  group_by(Gender) %>%
  summarise(n_incidents = n()) %>%
  arrange(desc(n_incidents))

DogsBites_by_gender_2019

```

```{r count-gender}
  
# Let's count the incidents by gender

DogsBites_by_gender_2021 <- NYC_Dog_Bites2021 %>%
  group_by(Gender) %>%
  summarise(n_incidents = n()) %>%
  arrange(desc(n_incidents))

DogsBites_by_gender_2021

```

```{r Gender-vs-SpayNeuter}

Gender_SpayNeuter_2019 <- NYC_Dog_Bites2019 %>%
  group_by(Gender) %>%
  count(Gender, SpayNeuter) %>%
  mutate(percent = 100 * n / sum(n)) %>%
  arrange(desc(n))

head(Gender_SpayNeuter_2019,10)


```

### Data Visualization

```{r}
genders_2019 <- NYC_Dog_Bites2019 %>%
                filter(!is.na(Gender), 
                str_to_lower(Gender) != "unknown",
                !is.na(SpayNeuter)) %>%
                add_count(Gender, name = "gender_total") %>%
                filter(gender_total %in% tail(sort(unique(gender_total)), 10))

# Create plot

ggplot(data= genders_2019, aes(x = fct_reorder(Gender, Gender, length), y = 1, fill = SpayNeuter)) +
  geom_col(position = "fill") +
  coord_flip() +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Spay/Neuter Status by Genders in Bite Incidents for 2019",
    x = "Dog Gender",
    y = "Proportion of Incidents",
    fill = "Spay/Neuter Status") +
  theme_minimal()
```

```{r}
genders_2021 <- NYC_Dog_Bites2021 %>%
                filter(!is.na(Gender), 
                str_to_lower(Gender) != "unknown",
                !is.na(SpayNeuter)) %>%
                add_count(Gender, name = "gender_total") %>%
                filter(gender_total %in% tail(sort(unique(gender_total)), 10))

# Create plot

ggplot(data= genders_2021, aes(x = fct_reorder(Gender, Gender, length), y = 1, fill = SpayNeuter)) +
  geom_col(position = "fill") +
  coord_flip() +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Spay/Neuter Status by Genders in Bite Incidents for 2021",
    x = "Dog Gender",
    y = "Proportion of Incidents",
    fill = "Spay/Neuter Status") +
  theme_minimal()
```

## Conclusion

My initial assumption that the years would affect the number of bite incidents was correct in that there was a noticeable increase in bites from 2019. However, there was not much of a change from the top ten breeds responsible. Pitbulls remain as the greatest offender, with German Shepherds and Shih Tzu behind them.  
<br>
The addtional analysis I performed on the genders revealed that a huge majority of the bites were from males/unknowns in 2019 and 2021. The visualizations for the Spay/Neuter stats vs Gender also do not reveal much preference for being spayed/neutered and biting for either gender. Although, interestingly the unknowns have a huge difference. 
